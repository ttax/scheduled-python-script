# 工作流名称
name: 定时运行基金钉钉通知脚本

# 触发规则：每天9点-15点每小时50分 + 手动触发
on:
  # 定时触发（UTC时间，对应北京时间 9:50-15:50 每小时执行）
  schedule:
    - cron: '50 1-7 * * *'  # UTC 1:50-7:50 = 北京时间 9:50-15:50
  # 手动触发（测试用）
  workflow_dispatch:

# 任务配置
jobs:
  run-fund-script:
    runs-on: ubuntu-latest
    # 配置环境变量（存放钉钉机器人Token，避免硬编码）
    env:
      DINGTALK_WEBHOOK: ${{ secrets.DINGTALK_WEBHOOK }}

    steps:
      # 步骤1：拉取仓库代码
      - name: 拉取仓库代码
        uses: actions/checkout@v4

      # 步骤2：设置Python环境
      - name: 设置Python环境
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      # 步骤3：安装依赖（你的脚本需要requests库）
      - name: 安装依赖
        run: |
          python -m pip install --upgrade pip
          pip install requests

      # 步骤4：执行脚本（直接执行根目录下的 script.py）
      - name: 运行基金通知脚本
        run: python script.py
